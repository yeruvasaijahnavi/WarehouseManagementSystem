import{a as $,b as k}from"./chunk-NA7KRPX3.js";import{a as U}from"./chunk-LAF7HK6A.js";import{G as E,N as y,O as M,P as F,X as j,ga as L,ha as P,o as S,p as I,q as T,r as w}from"./chunk-THIE4GUI.js";import{o as B}from"./chunk-35DERIXT.js";import{a as R}from"./chunk-KEDPSKOD.js";import{Jb as n,Kb as i,Lb as c,Nc as _,Ub as l,Uc as x,X as h,Ya as a,Za as C,_c as O,aa as f,ba as g,cc as v,dc as p,ib as b,na as m,pb as d,rc as D,zb as o}from"./chunk-ECNHR75B.js";var A=(()=>{class e{constructor(t){this.http=t,this.baseUrl=`${R.apiUrl}/dashboard`}getTotalOrders(){return this.http.get(`${this.baseUrl}/orders-total-count`)}getDistinctCustomerCount(){return this.http.get(`${this.baseUrl}/orders-distinct-customers`)}getOrderStatusDistribution(){return this.http.get(`${this.baseUrl}/orders-status-distribution`)}static{this.\u0275fac=function(r){return new(r||e)(f(O))}}static{this.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function V(e,s){e&1&&(m(),c(0,"svg",8))}function z(e,s){e&1&&(m(),c(0,"svg",9))}function W(e,s){if(e&1&&(n(0,"c-row",3)(1,"c-col",4)(2,"c-widget-stat-f",5),d(3,V,1,0,"ng-template",6),i()(),n(4,"c-col",4)(5,"c-widget-stat-f",7),d(6,z,1,0,"ng-template",6),i()()()),e&2){let t=l();a(2),o("title","Total Orders")("value",t.totalOrders!==null?t.totalOrders:"Loading..."),a(3),o("title","Distinct Customers")("value",t.customerCount!==null?t.customerCount:"Loading...")}}function H(e,s){if(e&1&&(n(0,"div")(1,"h3",11),p(2,"Order Status"),i(),c(3,"c-chart",12),i()),e&2){let t=l(2);a(3),o("data",t.pieChartData)}}function N(e,s){e&1&&(n(0,"div",13)(1,"p"),p(2,"Loading chart..."),i()())}function q(e,s){if(e&1&&(n(0,"div"),d(1,H,4,1,"div",10)(2,N,3,0,"ng-template",null,0,D),i()),e&2){let t=v(3),r=l();a(),o("ngIf",r.isPieChartDataLoaded)("ngIfElse",t)}}var ct=(()=>{class e{constructor(t){this.orderDashboardService=t,this.totalOrders=null,this.customerCount=null,this.pieChartData={labels:[],datasets:[{backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0"],data:[]}]},this.data={labels:["VueJs","EmberJs","ReactJs","Angular"],datasets:[{backgroundColor:["#41B883","#E46651","#00D8FF","#DD1B16"],data:[40,20,80,10]}]},this.isPieChartDataLoaded=!1,this.authService=g(U)}ngOnInit(){this.fetchTotalOrders(),this.fetchDistinctCustomerCount(),this.fetchOrderStatusDistribution()}fetchOrderStatusDistribution(){this.orderDashboardService.getOrderStatusDistribution().subscribe({next:t=>{this.pieChartData.labels=t.map(r=>r.status),this.pieChartData.datasets[0].data=t.map(r=>r.count),this.isPieChartDataLoaded=!0,console.log("Pie chart data loaded:",this.pieChartData.labels,this.pieChartData.datasets[0].data)},error:t=>console.error("Error fetching order status distribution:",t)})}fetchTotalOrders(){this.orderDashboardService.getTotalOrders().subscribe({next:t=>{console.log(t),this.totalOrders=t.totalOrders},error:t=>console.error("Error fetching total orders:",t)})}fetchDistinctCustomerCount(){this.orderDashboardService.getDistinctCustomerCount().subscribe({next:t=>{console.log("dist cust",t),this.customerCount=t.distinctCustomers},error:t=>console.error("Error fetching customer count:",t)})}static{this.\u0275fac=function(r){return new(r||e)(C(A))}}static{this.\u0275cmp=b({type:e,selectors:[["app-order-dashboard"]],decls:2,vars:2,consts:[["loadingTemplate",""],["class","my-4",4,"ngIf"],[4,"ngIf"],[1,"my-4"],["xl","6","lg","6","md","6","sm","12",1,"margin-class"],["color","warning","padding","",3,"title","value"],["cTemplateId","widgetIconTemplate"],["color","info","padding","",3,"title","value"],["cIcon","","name","cilInbox","size","xl","width","32"],["cIcon","","name","cilPeople","size","xl","width","32"],[4,"ngIf","ngIfElse"],[1,"inline","mx-auto"],["type","doughnut",1,"w-50","mx-auto",3,"data"],[1,"text-center"]],template:function(r,u){r&1&&d(0,W,7,4,"c-row",1)(1,q,4,2,"div",2),r&2&&(o("ngIf",u.authService.hasRole("admin")),a(),o("ngIf",u.authService.hasRole("admin")))},dependencies:[B,w,T,P,L,j,E,k,$,I,S,y,M,F,x,_],encapsulation:2})}}return e})();export{ct as a};
